<h2 class="text-3xl font-bold mb-4">Chapter 3.1: Math and Vectors</h2>
<p>Portal 2 is a 3D game built on physics and geometry. To manipulate anything in this world, from aiming a turret to calculating the distance to a button, you'll need to use math. VScript provides two core mathematical tools: the <strong>Vector</strong> data type and a built-in <strong>Math Library</strong>.</p>

<h3 class="text-2xl font-bold mt-8 mb-4">Vectors: Navigating 3D Space</h3>
<p>A <strong>Vector</strong> is a container for three <strong>Float</strong> numbers: X, Y, and Z. It's the primary tool for working with positions, directions, and angles.</p>
<pre><code class="language-squirrel">// Create a vector representing a position in the map.
local position = Vector(128, 256, -64)

// Access the individual components
printl("X coordinate: " + position.x) // Prints 128</code></pre>
<h4 class="text-xl font-bold mt-6 mb-2">Vector Math</h4>
<p>You can perform math operations directly on vectors. This is incredibly useful for calculating new positions.</p>
<ul class="list-disc list-inside">
    <li><strong>Addition/Subtraction:</strong> Adds or subtracts each component. <code>Vector(10, 20, 30) + Vector(1, 2, 3)</code> results in <code>Vector(11, 22, 33)</code>.</li>
    <li><strong>Multiplication by a number:</strong> Scales the vector. <code>Vector(10, 20, 30) * 2</code> results in <code>Vector(20, 40, 60)</code>.</li>
</ul>

<p class="p-4 bg-yellow-100 dark:bg-yellow-900 border-l-4 border-yellow-500 rounded-r-lg">
    <strong>Note:</strong> VSquirrel's Vector type does not support direct division by a number (e.g., <code>myVector / 2</code> will cause a script error). To achieve division, you must multiply by a fraction instead. For example, to halve a vector, you would write <code>myVector * 0.5</code> or <code>myVector * (1.0 / 2)</code>.
</p>

<pre><code class="language-squirrel">// Example: Moving a Cube
local cube = Entities.FindByName(null, "my_cube")
local startPos = cube.GetOrigin()
local offset = Vector(0, 0, 100) // We want to move it up by 100 units.
local endPos = startPos + offset
cube.SetOrigin(endPos)</code></pre>

<h3 class="text-2xl font-bold mt-8 mb-4">More Than Just Position: Angles</h3>
<p>Vectors are also used to represent an entity's rotation in 3D space. When used for angles, the components have special meanings:</p>
<ul class="list-disc list-inside">
    <li><strong>X:</strong> Pitch (tilting up and down)</li>
    <li><strong>Y:</strong> Yaw (turning left and right)</li>
    <li><strong>Z:</strong> Roll (tilting side to side)</li>
</ul>
<pre><code class="language-squirrel">// Example: Rotating a Turret
local turret = Entities.FindByName(null, "turret_01")
local currentAngles = turret.GetAngles()

// We want to make the turret face 90 degrees to its right.
local rotation = Vector(0, 90, 0) // 90 degrees on the Yaw axis
local newAngles = currentAngles + rotation

// The SetAngles function needs three separate numbers, not one Vector object.
turret.SetAngles(newAngles.x, newAngles.y, newAngles.z)
</code></pre>

<h3 class="text-2xl font-bold mt-8 mb-4">Useful Vector Methods</h3>
<p>Vectors have built-in functions that make common calculations easy.</p>
<ul class="list-disc list-inside">
    <li><code>.Length()</code>: Returns the length of the vector (its distance from the world's center at <code>Vector(0,0,0)</code>).</li>
    <li><code>(vec1 - vec2).Length()</code>: A common and very useful trick to get the <strong>distance between two points</strong>.</li>
</ul>
<pre><code class="language-squirrel">// Example: Check if the player is close enough to a button
local player = GetPlayer()
local button = Entities.FindByName(null, "the_button")

local playerPos = player.GetOrigin()
local buttonPos = button.GetOrigin()

local distance = (playerPos - buttonPos).Length()

if (distance < 100) { // 100 is our activation range
    printl("Player is in range!")
}
</code></pre>

<h3 class="text-2xl font-bold mt-8 mb-4">The Global Math Library</h3>
<p>Squirrel provides a set of standard mathematical functions that are always available. You don't need to include any special libraries to use them.</p>
<h4 class="text-xl font-bold mt-6 mb-2">Rounding & Absolute Value</h4>
<ul class="list-disc list-inside">
    <li><code>floor(x)</code>: Rounds a number <strong>down</strong> to the nearest whole number. <code>floor(3.9)</code> is <code>3.0</code>.</li>
    <li><code>ceil(x)</code>: Rounds a number <strong>up</strong> to the nearest whole number. <code>ceil(3.1)</code> is <code>4.0</code>.</li>
    <li><code>abs(x)</code>: Returns the absolute (non-negative) value. <code>abs(-5)</code> is <code>5</code>.</li>
</ul>
<h4 class="text-xl font-bold mt-6 mb-2">Exponents & Logarithms</h4>
<ul class="list-disc list-inside">
    <li><code>sqrt(x)</code>: Returns the square root of a number.</li>
    <li><code>pow(base, exponent)</code>: Returns the `base` raised to the power of `exponent`. <code>pow(2, 3)</code> is <code>8</code>.</li>
    <li><code>log(x)</code>: Returns the natural logarithm of x.</li>
</ul>
<h4 class="text-xl font-bold mt-6 mb-2">Trigonometry</h4>
<p>These functions are essential for working with angles and rotations. They all work with angles in <strong>radians</strong>, not degrees!</p>
<ul class="list-disc list-inside">
    <li><code>sin(rad)</code>, <code>cos(rad)</code>, <code>tan(rad)</code>: Standard trigonometric functions.</li>
    <li><code>asin(x)</code>, <code>acos(x)</code>, <code>atan(x)</code>: Inverse trigonometric functions.</li>
    <li><code>atan2(y, x)</code>: A very useful function that returns the angle in radians between the positive X-axis and the point (x, y).</li>
</ul>
<h4 class="text-xl font-bold mt-6 mb-2">Random Numbers</h4>
<p>To add unpredictability to your maps, you can use random number generators. While old methods exist, the modern and recommended way is to use the built-in <code>RandomInt()</code> and <code>RandomFloat()</code> functions.</p>
<ul class="list-disc list-inside">
    <li><code>RandomInt(min, max)</code>: Returns a random whole number between <code>min</code> and <code>max</code>, including both of those values.</li>
    <li><code>RandomFloat(min, max)</code>: Returns a random decimal number between <code>min</code> and <code>max</code>.</li>
</ul>

<pre><code class="language-squirrel">// Seed the generator ONCE at the very top of your script.
// Example 1: Choose a random announcement to play.
local choice = RandomInt(1, 3)
if (choice == 1) {
    printl("Playing announcement A...")
}
else if (choice == 2) {
    printl("Playing announcement B...")
}
else {
    printl("Playing announcement C...")
}

// Example 2: Drop a cube at a random horizontal position.
local randomX = RandomFloat(-200.0, 200.0)
local randomY = RandomFloat(-200.0, 200.0)
local spawnPosition = Vector(randomX, randomY, 512)
// Code to spawn a cube at spawnPosition...
</code></pre>